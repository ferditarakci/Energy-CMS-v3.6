<%Private Sub EnergyMenuFonksiyon( _	ByVal strCreateHtml, _	ByVal strMenuType, _	ByVal intAnaid, _	ByRef intLevel _)	intLevel = Cint(intLevel)	Dim Counts, MenuSay, objSubRs	Dim intMenuid, intMenuParentid, strTag, strTitle, strText, strTarget	Dim strRel, strClass, strStyle, blnSubs, strBaglantiTuru, LiCssClass, strLinkParentClass, iUrlWrite	SQL = ""	SQL = SQL & "SELECT" & vbCrLf	SQL = SQL & "	Count(a.id)" & vbCrLf	SQL = SQL & "FROM #___content_menu As a" & vbCrLf	SQL = SQL & "INNER JOIN #___content_menu_type As b ON a.menu_id = b.id" & vbCrLf	'SQL = SQL & "LEFT JOIN #___content As c ON c.parent = a.parent And c.parent_id = a.parent_id" & vbCrLf	SQL = SQL & "WHERE (" & vbCrLf	SQL = SQL & "	b.durum = 1" & vbCrLf	SQL = SQL & "	And a.lang = '"& GlobalConfig("site_lang") &"'" & vbCrLf	SQL = SQL & "	And b.type = '"& strMenuType &"'" & vbCrLf	SQL = SQL & "	And a.anaid = 0" & vbCrLf	SQL = SQL & ")" & vbCrLf	SQL = SQL & "ORDER BY a.sira ASC;"	'Clearfix setQuery(SQL)	Counts = Cdbl(sqlQuery(SQL, 0))	'Counts = Cdbl(sqlQuery("Call RecursiveMenuSum(0, '"& GlobalConfig("site_lang") &"', '"& strMenuType &"', '"& tablePrefix &"');", 0))	'Counts = Cdbl(sqlQuery(RecursiveMenuSum(0, strMenuType, GlobalConfig("site_lang"), AltMenu), 0))	'Counts = Cdbl(sqlQuery(RecursiveMenuSum(0, strMenuType, GlobalConfig("site_lang"), AltMenu), 0))	SQL = ""	SQL = SQL & "SELECT" & vbCrLf	SQL = SQL & "	a.id, a.parent, a.parent_id, a.menu_id, a.lang, b.id As typeid, " & vbCrLf	SQL = SQL & "	IFNULL(a.menu_tag, '') As menu_tag," & vbCrLf	SQL = SQL & "	IFNULL(a.title_attr, '') As title_attr," & vbCrLf	SQL = SQL & "	IFNULL(a.text_value, '') As text_value," & vbCrLf	SQL = SQL & "	IFNULL(a.rel_attr, '') As rel_attr," & vbCrLf	SQL = SQL & "	IFNULL(a.css_class, '') As css_class," & vbCrLf	SQL = SQL & "	IFNULL(a.css_style, '') As css_style," & vbCrLf	SQL = SQL & "	a.menu_target," & vbCrLf	SQL = SQL & "	IFNULL(b.strCaseUst, '') As strCaseUst," & vbCrLf	SQL = SQL & "	IFNULL(b.strCaseAlt, '') As strCaseAlt," & vbCrLf	SQL = SQL & "	(" & vbCrLf	SQL = SQL & "		SELECT Count(a1.id) As cn" & vbCrLf	SQL = SQL & "		FROM #___content_menu As a1" & vbCrLf	SQL = SQL & "		WHERE (" & vbCrLf	SQL = SQL & "			a1.anaid = a.id" & vbCrLf	SQL = SQL & "		)" & vbCrLf	SQL = SQL & "		Limit 1" & vbCrLf	SQL = SQL & "	) As alt_menu" & vbCrLf	SQL = SQL & "FROM #___content_menu As a" & vbCrLf	SQL = SQL & "INNER JOIN #___content_menu_type As b ON a.menu_id = b.id" & vbCrLf	SQL = SQL & "WHERE (" & vbCrLf	SQL = SQL & "	b.durum = 1" & vbCrLf	SQL = SQL & "	And a.lang = '"& GlobalConfig("site_lang") &"'" & vbCrLf	SQL = SQL & "	And b.type = '"& strMenuType &"'" & vbCrLf	SQL = SQL & "	And a.anaid = "& intAnaid &"" & vbCrLf	SQL = SQL & ")" & vbCrLf	SQL = SQL & "ORDER BY a.sira ASC;"	'Clearfix setQuery(SQL)	Set objSubRs = setExecute(SQL)	With Response		If Not objSubRs.Eof Then			'// vbTab Yaz			If intLevel > 0 Then .Write(vbCrLf & String((intLevel * 2), vbTab))'If intLevel = 0 Then strClass = strClass & " topLevel" Else strClass = strClass & " subLevel level-" & intLevel & ""			'// Alt Menü UL Element Aç			If intLevel > 0 Then .Write("<ul class=""ul-level-" & intLevel & """>" & vbCrLf & String(intLevel, vbTab))			Do While Not objSubRs.Eof				'// Menü idsi				intMenuid = Cdbl(objSubRs("id"))				intMenuParentid = Cdbl(objSubRs("parent_id"))				'// Permalink Bağlantı Türü				strBaglantiTuru = ParentNumber(objSubRs("parent"))				If strBaglantiTuru = GlobalConfig("General_CustomURL") Then intMenuParentid = Cdbl(objSubRs("id"))				'// Menü Etiket				strTag = objSubRs("menu_tag") & ""				'// Menü Link Title				strTitle = objSubRs("title_attr") & ""				If strTitle = "" Then strTitle = strTag				'// Menü Link Text				strText = objSubRs("text_value") & ""				'If strText <> "" Then strText = "<p class=""mText"">" & strText & "</p>"				'// Target Özniteliği				strTarget = ""				If objSubRs("menu_target") = 1 Then strTarget = " target=""_blank"""				If objSubRs("menu_target") = 2 Then strTarget = " target=""_top"""				'// Rel Özniteliği				strRel = objSubRs("rel_attr") & ""				If strRel <> "" Then strRel = " rel=""" & strRel & """"				'// Class Özniteliği				strClass = objSubRs("css_class") '&  " " & SefURL(strTag)				strClass = TrimFix(strClass)				'If strClass <> "" Then strClass = " class=""" & strClass & """				'If strClass <> "" Then strClass = strClass &  " "				If intLevel = 0 Then strClass = strClass & " topLevel" Else strClass = strClass & " subLevel link-level-" & intLevel & ""				'// Style Özniteliği				strStyle = objSubRs("css_style") & ""				If strStyle <> "" Then strStyle = " style=""" & strStyle & """"				'// Alt Menü Kontrol				blnSubs = CBool(objSubRs("alt_menu"))				LiCssClass = ""				'Clearfix GlobalConfig("request_option") = GlobalConfig("General_Home") And strBaglantiTuru = GlobalConfig("General_Home")				If GlobalConfig("request_option") = GlobalConfig("General_Home") And strBaglantiTuru = GlobalConfig("General_Home") Then LiCssClass = LiCssClass & "active"				'// Başlama ve Bitiş Sınıfları				If intLevel = 0 Then					MenuSay = MenuSay + 1					If (MenuSay = 1 And Counts > 1) Then						LiCssClass = LiCssClass & " first"					ElseIf (MenuSay = Counts) Then						LiCssClass = LiCssClass & " last"					End If				End If				'// ParentClass = True And blnSubs = True				'If ParentClass And blnSubs Then LiCssClass = LiCssClass & " parent"				'// Find Menu ID				If CBool(instr(GlobalConfig("activeMenuid"), "["& intMenuid &"]")) Then LiCssClass = LiCssClass & " active"				'// Alt Menü İkonları				'If blnSubs And intLevel = 0 Then				'	LiCssClass = LiCssClass & " sArrow"				'ElseIf blnSubs And intLevel > 0 Then				'	LiCssClass = LiCssClass & " ssArrow"				'End If				'// Menü Li Class				LiCssClass = LiCssClass & " li-level-" & (intLevel + 1) & ""				LiCssClass = Trim(LiCssClass)				If LiCssClass <> "" Then LiCssClass = " class="""& LiCssClass &""""				'// vbTab Yaz				If intLevel > 0 Then .Write(String(intLevel, vbTab))				.Write(String(1, vbTab))				'// Menü LI Element Aç				.Write("<li"& LiCssClass &">")				'If intUzunluk > 0 Then					'strTitle = Duzenle( strTitle )				'	strTitle = KacKarekter(strTitle, intUzunluk)					'strTitle = Temizle(strTitle, -1)				'End If				If objSubRs("strCaseUst") <> "" And intLevel = 0 Then _					strTag = GetRef( objSubRs("strCaseUst") )( strTag ) ': strTitle = GetRef( MenuCase )( strTitle )				If objSubRs("strCaseAlt") <> "" And intLevel > 0 Then _					strTag = GetRef( objSubRs("strCaseAlt") )( strTag ) ': strTitle = GetRef( MenuCase )( strTitle )				strTitle = HtmlEncode( strTitle )				If inStr(1, strCreateHtml, "href=""{!base}") > 0 Then					iUrlWrite = UrlWrite(GlobalConfig("sBase"), GlobalConfig("site_lang"), strBaglantiTuru, "", "", intMenuParentid, "", "")				Else					iUrlWrite = UrlWrite("", GlobalConfig("site_lang"), strBaglantiTuru, "", "", intMenuParentid, "", "")				End If				strLinkParentClass = ""				'If intLevel = 0 Then .Write("<h3>") Else .Write("<h4>")				If intLevel = 0 Then strLinkParentClass = " class=""link""" Else strLinkParentClass = " class=""sublink"""				iUrlWrite = Replace(strCreateHtml, "{!href}", iUrlWrite)				iUrlWrite = Replace(iUrlWrite, "{!base}", "")				iUrlWrite = Replace(iUrlWrite, "{!tag}", TrimFix(strTag))				iUrlWrite = Replace(iUrlWrite, "{!title}", " title=""" & TrimFix(strTitle) & """ ")				iUrlWrite = Replace(iUrlWrite, "{!class}", TrimFix(strClass))				'// Alt Menü İkonları				If blnSubs And intLevel = 0 Then					iUrlWrite = Replace(iUrlWrite, "{!arrowClass}", " navArrow ")				ElseIf blnSubs And intLevel > 0 Then					iUrlWrite = Replace(iUrlWrite, "{!arrowClass}", " subNavArrow ")				Else					iUrlWrite = Replace(iUrlWrite, "{!arrowClass}", "")				End If				iUrlWrite = Replace(iUrlWrite, "{!style}", TrimFix(strStyle))				iUrlWrite = Replace(iUrlWrite, "{!target}", TrimFix(strTarget))				iUrlWrite = Replace(iUrlWrite, "{!rel}", TrimFix(strRel))				iUrlWrite = Replace(iUrlWrite, "{!text}", TrimFix(strText))				iUrlWrite = Replace(iUrlWrite, "{!linkParentClass}", strLinkParentClass)				iUrlWrite = TrimFix(iUrlWrite)				iUrlWrite = Replace(iUrlWrite, "="" ", "=""")				iUrlWrite = Replace(iUrlWrite, " >", ">")				iUrlWrite = Replace(iUrlWrite, " """, """")				iUrlWrite = Replace(iUrlWrite, " class=""""", "")				'iUrlWrite = Replace(iUrlWrite, "{{rel}}", TrimFix(strRel))				.Write( iUrlWrite )				'.Write("<a href="""& iUrlWrite &""""& strStyle &" class="""& strClass & SefURL(strTitle) &""" title="""& strTitle &""""& strRel & strTarget &">")				'.Write("<span"& SpanCssClass &">")				'.Write("<span>")				'If inStrBot() Then .Write( strTitleFull ) Else .Write( strTitle )				'.Write( strTag )				'.Write("</span>")				'.Write("</a>")				'If intLevel = 0 Then .Write("</h3>") Else .Write("</h4>")				'.Write("</div>")				'// Alt Menü Çağır				'If AltMenu = "AltMenuOK" Then _					Call EnergyMenuFonksiyon( _						strCreateHtml, _						strMenuType, _						intMenuid, _						intLevel + 1 _					)				'// Menü LI Element Kapat				.Write("</li>")				'// Alt Satırdan Devam Et				If Not (MenuSay = Counts) Then .Write( vbCrLf )				'// vbTab Yaz				If intLevel > 0 Then .Write(String(intLevel, vbTab))				objSubRs.MoveNext() : Loop				'// Alt Menü UL Element Kapat				If intLevel > 0 Then .Write(String(intLevel, vbTab) & "</ul>" & vbCrLf)				'// vbTab Yaz				If intLevel > 0 Then .Write(String(((intLevel * 2) - 1), vbTab))		End If	Set objSubRs = Nothing	End WithEnd SubSub ewyActiveMenu2(ByVal Parentid)	Dim sSQL, objSubRs	sSQL = ""	sSQL = sSQL & "SELECT" & vbCrLf	sSQL = sSQL & "    t1.id, t1.anaid, t1.parent_id" & vbCrLf	sSQL = sSQL & "FROM #___content_menu t1" & vbCrLf	sSQL = sSQL & "WHERE (" & vbCrLf	sSQL = sSQL & "    (t1.id = "& Parentid &")" & vbCrLf	sSQL = sSQL & ");"'	Clearfix setQuery( sSQL )	Set objSubRs = setExecute( sSQL )		Do While Not objSubRs.Eof			GlobalConfig("activeMenuid") = GlobalConfig("activeMenuid") & "[" & objSubRs("id") & "]"			Call ewyActiveMenu2(objSubRs("anaid"))		objSubRs.MoveNext() : Loop	Set objSubRs = NothingEnd SubSub ewyActiveMenu(ByVal Parentid)	Dim sSQL, objSubRs	sSQL = ""	sSQL = sSQL & "SELECT" & vbCrLf	sSQL = sSQL & "    t1.id, t1.anaid, t1.parent_id" & vbCrLf	sSQL = sSQL & "FROM #___content_menu t1" & vbCrLf	sSQL = sSQL & "WHERE (" & vbCrLf	sSQL = sSQL & "    (t1.anaid = "& Parentid &" Or t1.parent_id = "& Parentid &")" & vbCrLf	sSQL = sSQL & ");"'	Clearfix setQuery( sSQL )	Set objSubRs = setExecute( sSQL )		Do While Not objSubRs.Eof			GlobalConfig("activeMenuid") = GlobalConfig("activeMenuid") & "[" & objSubRs("id") & "]"			Call ewyActiveMenu2(objSubRs("anaid"))		objSubRs.MoveNext() : Loop	Set objSubRs = NothingEnd SubSub ewyPathway(ByRef Parent, ByVal intid)	Dim sSQL, objSubRs, strMenuTag, strTitle, strBaglantiTuru, strTarget, strRel, UrlYaz, strTabloAdi	strTabloAdi = "sayfa" : If Parent = GlobalConfig("General_Categories") Then strTabloAdi = "kategori"	sSQL = ""	sSQL = sSQL & "SELECT" & vbCrLf	sSQL = sSQL & "    t1.id, t1.anaid, t2.title, t2.parent, t2.parent_id As menuid" & vbCrLf	sSQL = sSQL & "FROM #___"& strTabloAdi &" t1" & vbCrLf	sSQL = sSQL & "INNER JOIN #___content t2 ON t1.id = t2.parent_id" & vbCrLf	sSQL = sSQL & "WHERE (" & vbCrLf	sSQL = sSQL & "    t1.id = "& intid &"" & vbCrLf	sSQL = sSQL & "    And t2.parent = '"& Parent &"'" & vbCrLf	sSQL = sSQL & "    And t2.lang = '"& GlobalConfig("site_lang") &"'" & vbCrLf	sSQL = sSQL & ");"	Set objSubRs = setExecute( sSQL )		Do While Not objSubRs.Eof			strTitle = UCase2(HtmlEncode(objSubRs("title")))			strBaglantiTuru = ParentNumber(objSubRs("parent"))			Call ewyActiveMenu(objSubRs("menuid"))			Call ewyPathway(Parent, Cdbl(objSubRs("anaid")))			UrlYaz = UrlWrite("", GlobalConfig("site_lang"), strBaglantiTuru, "", "", objSubRs("id"), 0, "")			GlobalConfig("cpathway") = GlobalConfig("cpathway") & "<li class=""icon""><a href="""& UrlYaz &""" class="""& SefURL(strTitle) &""" title="""& BasHarfBuyuk(strTitle) &""">"& strTitle &"</a></li> "		objSubRs.MoveNext() : Loop	Set objSubRs = NothingEnd Sub'Sub HomePageLink(ByVal MenuCase)'	Dim strTitle, strTitle2, HomeUrl, HomeActive''	strTitle = Lang("anasayfa") : If MenuCase <> "" Then strTitle = GetRef( MenuCase )( strTitle )'	strTitle2 = strTitle'	If inStr(1, Site_HTTP_HOST, "webdizayni.org", 1) > 0 Then strTitle2 = "Web Tasarım"'	HomeActive = "" : If GlobalConfig("request_option") = GlobalConfig("General_Home") Then HomeActive = " active"''	HomeUrl = UrlWrite("", GlobalConfig("site_lang"), GlobalConfig("General_Home"), "", "", "", "", "")''	Response.Write(vbTab & "<li class=""first home"& HomeActive &""">")'	Response.Write("<div class=""link"">")'	Response.Write("<a href="""& HomeUrl &""" class="""& SefURL(strTitle) &""" title="""& BasHarfBuyuk(strTitle2) &"""><span>"& strTitle &"</span></a>")'	Response.Write("</div>")'	Response.Write("</li>" & vbCrLf)'End Sub'// Devamını Oku Bağlantısı Ekleme FonksiyonuPrivate Function ReadMore(ByVal strAttr, ByVal strTitle, ByVal strLinkText, ByVal strLink, ByVal varText)	varText = varText & "" : If varText = "" Then Exit Function	Dim strAra : strAra = inStr(1, varText, "<hr id=""readmore"" />", 1)	If CBool(strAra) Then		varText = Mid(varText, 1, strAra -1)		If strLink <> "javascript:;" Then			If strAttr <> "" Then strAttr = " " & strAttr			'varText = varText & "<p class=""clearfix"">" & vbCrLf			varText = varText & "	<a"& strAttr &" href=""" & strLink & """ title=""" & strTitle & """><span>" & ReadMoreText(strLinkText) & "</span></a>" & vbCrLf			'varText = varText & "</p>" & vbCrLf		End If	End If	varText = Replace(varText, "<hr id=""readmore"" />", "")	ReadMore = varTextEnd Function'Clearfix ReadMore("class=""readmore""", strTitle, Lang("page_devami"), strLinks, strText)Function ReadMoreText(ByVal strMore)	strMore = strMore & ""	ReadMoreText = Lang("page_devami") : If strMore <> "" Then ReadMoreText = strMoreEnd FunctionSub ActionPost(ByVal addCssClass, ByVal addTextMessage)	Dim Action	Set Action = jsObject()	Action("divClass") = addCssClass	Action("divMsg") = addTextMessage	Action.Flush	Set Action = Nothing	CloseDatabase data	Response.End()End SubDim arrListPage, arrListPage2Sub CommentPost(ByVal addCssClass, ByVal addTextMessage, ByVal formArray)	Dim Action	Set Action = jsObject()	Action("divClass") = addCssClass	Action("divMsg") = addTextMessage	Action("htmlForm") = formArray	Action.Flush	Set Action = Nothing	CloseDatabase data	Response.End()End Sub%>
